<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>lensfun: example.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    messageStyle: "none"
});
</script><script type="text/javascript" src="http://lensfun.github.io/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="lensfun-manual.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">lensfun
   &#160;<span id="projectnumber">0.3.95.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">example.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Sample program demonstrating basic usage of C API.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">    A simple example of library usage from plain C</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="lensfun_8h.html">lensfun.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;locale.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;glib.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> i, j;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a0"></a><a class="code" href="structlfMount.html">lfMount</a> *<span class="keyword">const</span> *mounts;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structlfCamera.html">lfCamera</a> *<span class="keyword">const</span> *cameras;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structlfLens.html">lfLens</a> *<span class="keyword">const</span> *lenses;</div><div class="line">    <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structlfDatabase.html">lfDatabase</a> *ldb;</div><div class="line">    <a class="code" href="group__Auxiliary.html#gaf84c98d42624e1181549de773ac49ad7">lfError</a> e;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize locale in order to get translated names */</span></div><div class="line">    setlocale (LC_ALL, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    ldb = <a name="a4"></a><a class="code" href="group__Database.html#gaba8beb8c4e635dc8f0f976c277cf9f5e">lf_db_new</a> ();</div><div class="line">    <span class="keywordflow">if</span> (!ldb)</div><div class="line">    {</div><div class="line">        fprintf (stderr, <span class="stringliteral">&quot;Failed to create database\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> -1;</div><div class="line">    }</div><div class="line"></div><div class="line">    g_print (<span class="stringliteral">&quot;HomeDataDir: %s\n&quot;</span>, ldb-&gt;<a name="a5"></a><a class="code" href="structlfDatabase.html#a98d787a228dd61bedbc47fcaab9f6a01">HomeDataDir</a>);</div><div class="line"></div><div class="line">    <a name="a6"></a><a class="code" href="group__Database.html#ga61b028cbe1b70c5157e7e767efb2958b">lf_db_load</a> (ldb);</div><div class="line"></div><div class="line">    g_print (<span class="stringliteral">&quot;&lt; --------------- &lt; Mounts &gt; --------------- &gt;\n&quot;</span>);</div><div class="line">    mounts = <a name="a7"></a><a class="code" href="group__Database.html#gaafc5fd55e33d8371fbdcd6fd48669a46">lf_db_get_mounts</a> (ldb);</div><div class="line">    <span class="keywordflow">for</span> (i = 0; mounts [i]; i++)</div><div class="line">    {</div><div class="line">        g_print (<span class="stringliteral">&quot;Mount: %s\n&quot;</span>, <a name="a8"></a><a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (mounts [i]-&gt;Name));</div><div class="line">        <span class="keywordflow">if</span> (mounts [i]-&gt;Compat)</div><div class="line">            <span class="keywordflow">for</span> (j = 0; mounts [i]-&gt;<a name="a9"></a><a class="code" href="structlfMount.html#a614c1d48305c06d9baee2e8419b2e1ad">Compat</a> [j]; j++)</div><div class="line">                g_print (<span class="stringliteral">&quot;\tCompat: %s\n&quot;</span>, mounts [i]-&gt;Compat [j]);</div><div class="line">    }</div><div class="line"></div><div class="line">    g_print (<span class="stringliteral">&quot;&lt; --------------- &lt; Cameras &gt; --------------- &gt;\n&quot;</span>);</div><div class="line">    cameras = <a name="a10"></a><a class="code" href="group__Database.html#ga6c0998a85104af7b0a97e1a59f46545e">lf_db_get_cameras</a> (ldb);</div><div class="line">    <span class="keywordflow">for</span> (i = 0; cameras [i]; i++)</div><div class="line">    {</div><div class="line">        g_print (<span class="stringliteral">&quot;Camera: %s / %s %s%s%s\n&quot;</span>,</div><div class="line">            <a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (cameras [i]-&gt;Maker),</div><div class="line">            <a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (cameras [i]-&gt;Model),</div><div class="line">            cameras [i]-&gt;Variant ? <span class="stringliteral">&quot;(&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">            cameras [i]-&gt;Variant ? <a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (cameras [i]-&gt;Variant) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">            cameras [i]-&gt;Variant ? <span class="stringliteral">&quot;)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line">        g_print (<span class="stringliteral">&quot;\tMount: %s\n&quot;</span>, <a name="a11"></a><a class="code" href="group__Database.html#gab42f6e09d5a9d16d59329e6230a1240a">lf_db_mount_name</a> (ldb, cameras [i]-&gt;Mount));</div><div class="line">        g_print (<span class="stringliteral">&quot;\tCrop factor: %g\n&quot;</span>, cameras [i]-&gt;CropFactor);</div><div class="line">    }</div><div class="line"></div><div class="line">    g_print (<span class="stringliteral">&quot;&lt; --------------- &lt; Lenses &gt; --------------- &gt;\n&quot;</span>);</div><div class="line">    lenses = <a name="a12"></a><a class="code" href="group__Database.html#ga56393f26905e5146d92dfb59c58ca573">lf_db_get_lenses</a> (ldb);</div><div class="line">    <span class="keywordflow">for</span> (i = 0; lenses [i]; i++)</div><div class="line">    {</div><div class="line">        g_print (<span class="stringliteral">&quot;Lens: %s / %s\n&quot;</span>,</div><div class="line">            <a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (lenses [i]-&gt;Maker),</div><div class="line">            <a class="code" href="group__Auxiliary.html#ga8cfd1f7b20aa190b3ac4556301fdf299">lf_mlstr_get</a> (lenses [i]-&gt;Model));</div><div class="line">        g_print (<span class="stringliteral">&quot;\tCrop factor: %g\n&quot;</span>, lenses [i]-&gt;CropFactor);</div><div class="line">        g_print (<span class="stringliteral">&quot;\tAspect ratio: %g\n&quot;</span>, lenses [i]-&gt;AspectRatio);</div><div class="line">        g_print (<span class="stringliteral">&quot;\tFocal: %g-%g\n&quot;</span>, lenses [i]-&gt;MinFocal, lenses [i]-&gt;MaxFocal);</div><div class="line">        g_print (<span class="stringliteral">&quot;\tAperture: %g-%g\n&quot;</span>, lenses [i]-&gt;MinAperture, lenses [i]-&gt;MaxAperture);</div><div class="line">        g_print (<span class="stringliteral">&quot;\tCenter: %g,%g\n&quot;</span>, lenses [i]-&gt;CenterX, lenses [i]-&gt;CenterY);</div><div class="line">        <span class="keywordflow">if</span> (lenses [i]-&gt;Mounts)</div><div class="line">            <span class="keywordflow">for</span> (j = 0; lenses [i]-&gt;<a name="a13"></a><a class="code" href="structlfLens.html#a618dd1b96fea2fcfb1733b73bace9980">Mounts</a> [j]; j++)</div><div class="line">                g_print (<span class="stringliteral">&quot;\tMount: %s\n&quot;</span>, <a class="code" href="group__Database.html#gab42f6e09d5a9d16d59329e6230a1240a">lf_db_mount_name</a> (ldb, lenses [i]-&gt;Mounts [j]));</div><div class="line">    }</div><div class="line"></div><div class="line">    g_print (<span class="stringliteral">&quot;&lt; ---&lt; Saving database into one big file &gt;--- &gt;\n&quot;</span>);</div><div class="line">    e = <a name="a14"></a><a class="code" href="group__Database.html#gaa4cdbd5b21f7ce5fba41001a2109fbfe">lf_db_save_file</a> (ldb, <span class="stringliteral">&quot;example-big.xml&quot;</span>, mounts, cameras, lenses);</div><div class="line">    <span class="keywordflow">if</span> (e != <a name="a15"></a><a class="code" href="group__Auxiliary.html#ggaf84c98d42624e1181549de773ac49ad7a6419ef83b513591890978b83dd296765">LF_NO_ERROR</a>)</div><div class="line">        fprintf (stderr, <span class="stringliteral">&quot;Failed writing to file, error code %d\n&quot;</span>, e);</div><div class="line"></div><div class="line">    <a name="a16"></a><a class="code" href="group__Database.html#gaf62bd4cfa25f2145e4102a70a0baf7b7">lf_db_destroy</a> (ldb);</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 27 2019 05:02:17 for lensfun by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
